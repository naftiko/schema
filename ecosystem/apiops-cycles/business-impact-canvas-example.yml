canvasType: businessImpactCanvas

availabilityRisks: >
  DDoS Attacks:
  - Risk: Distributed denial of service overwhelming API infrastructure
  - Impact: Complete service outage affecting all merchants (Revenue loss: $50K per hour)
  - Probability: Medium (quarterly attempts observed)
  - Affected services: API gateway, load balancers, DNS
  
  Cloud Provider Outages:
  - Risk: AWS region failure affecting primary infrastructure
  - Impact: 30-60 minute outage until failover completes
  - Probability: Low (1-2 times per year based on AWS history)
  - Affected: All services in primary region
  
  Database Overload:
  - Risk: Traffic spike exceeds database capacity causing slowdowns/timeouts
  - Impact: Degraded performance, transaction processing delays
  - Probability: High during peak events (Black Friday, flash sales)
  - Affected: All write operations, transaction processing
  
  Deployment Failures:
  - Risk: Bad deployment introducing critical bugs
  - Impact: Service degradation or outage lasting 15-60 minutes
  - Probability: Medium (despite testing, issues occur ~monthly)
  - Affected: Recently deployed services/endpoints
  
  Third-Party Payment Processor Outage:
  - Risk: Stripe, Visa, or banking network disruption
  - Impact: Cannot process new transactions (existing data still accessible)
  - Probability: Low-Medium (1-2 times per quarter)
  - Affected: New transaction creation only
  
  DNS Failures:
  - Risk: DNS provider issues or misconfigurations
  - Impact: API unreachable, appears completely down to customers
  - Probability: Low (rare but catastrophic)
  - Affected: All services (complete outage)
  
  Certificate Expiration:
  - Risk: TLS certificate expires causing connection failures
  - Impact: All HTTPS connections fail, API becomes unreachable
  - Probability: Very Low (automated renewal, but still a risk)
  - Affected: All API endpoints

mitigateAvailabilityRisks: >
  DDoS Protection:
  - Cloudflare DDoS protection with 100+ Tbps capacity
  - Rate limiting at multiple layers (CDN, API gateway, application)
  - Automatic traffic pattern analysis and blocking
  - Geographic blocking for high-risk regions during attacks
  - Cost: $5,000/month for enterprise DDoS protection
  
  Multi-Region Deployment:
  - Active-active deployment in US-East and EU-West regions
  - Automatic failover with health checks every 10 seconds
  - DNS failover switches traffic in < 30 seconds
  - Cross-region database replication (5-second lag)
  - Target RTO: 15 minutes, RPO: 5 minutes
  - Cost: $15,000/month for multi-region infrastructure
  
  Database Capacity Management:
  - Auto-scaling read replicas (current: 5, can scale to 10)
  - Connection pooling with PgBouncer (2,000 connections max)
  - Query optimization and regular index maintenance
  - Slow query monitoring with automated alerts
  - Read replica promotion in < 30 seconds for failover
  - Quarterly load testing with 3x expected peak traffic
  
  Blue-Green Deployment:
  - Zero-downtime deployments using blue-green strategy
  - Health checks before switching traffic to new version
  - Automatic rollback if error rate > 2% after deployment
  - Canary deployments for risky changes (5% → 25% → 100%)
  - Feature flags for gradual feature rollout
  - Deployment during low-traffic hours (2-4 AM EST)
  
  Payment Processor Redundancy:
  - Primary processor: Stripe
  - Backup processor: Braintree (hot standby)
  - Automatic failover if primary fails > 3 consecutive attempts
  - Cost: Additional 0.5% processing fee for backup
  
  DNS Redundancy:
  - Primary DNS: Route53 (AWS)
  - Secondary DNS: Cloudflare
  - TTL: 60 seconds for fast failover
  - Monitoring: DNS health checks every 60 seconds
  - Alert on DNS resolution failures
  
  Certificate Management:
  - Automated certificate renewal via Let's Encrypt
  - Renewal 30 days before expiration
  - Monitoring alerts 14 days before expiration
  - Manual backup process documented
  - Certificate stored in multiple locations
  
  99.9% Uptime SLA:
  - Allowed downtime: 43 minutes per month
  - Status page: status.payment.com with real-time updates
  - Incident response team: On-call 24/7 rotation
  - Escalation: P1 incidents escalate to CTO within 15 minutes
  - Service credits: 10% monthly fee for each 0.1% below SLA

securityRisks: >
  API Key Theft and Unauthorized Access:
  - Risk: Stolen or leaked API keys used by malicious actors
  - Impact: Unauthorized transactions, data exfiltration, account takeover
  - Potential damage: $500K+ in fraudulent transactions before detection
  - Attack vectors: GitHub commits, client-side code, phishing
  
  SQL Injection Attacks:
  - Risk: Malicious SQL injected through API parameters
  - Impact: Data breach, unauthorized data access, data manipulation
  - Sensitive data at risk: Customer PII, payment tokens, transaction history
  - Probability: Medium (automated attacks constantly scanning)
  
  Man-in-the-Middle (MITM) Attacks:
  - Risk: Traffic intercepted between client and API
  - Impact: Stolen credentials, payment data exposure, transaction tampering
  - Most vulnerable: Clients not using TLS 1.3, certificate pinning
  
  Credential Stuffing:
  - Risk: Automated login attempts using leaked credentials from other breaches
  - Impact: Account takeovers, unauthorized transactions
  - Target: Merchant dashboard logins, API key endpoints
  
  Insufficient Rate Limiting Enabling Abuse:
  - Risk: Attackers exploit API to test stolen cards or enumerate data
  - Impact: Resource exhaustion, data harvesting, financial fraud
  - Examples: Card testing attacks, brute force attempts
  
  Sensitive Data Exposure in Logs:
  - Risk: PII or payment data inadvertently logged in application logs
  - Impact: Compliance violations, data breach if logs accessed
  - Regulatory exposure: GDPR fines up to €20M or 4% revenue
  
  Insider Threats:
  - Risk: Malicious or negligent employee accessing customer data
  - Impact: Data breach, unauthorized transactions, reputation damage
  - Access: Database access, admin dashboards, production servers
  
  Third-Party Vendor Compromise:
  - Risk: Security breach at partner (e.g., email provider, analytics)
  - Impact: Indirect data exposure, supply chain attack
  - Examples: Twilio breach exposing customer phone numbers

mitigateSecurityRisks: >
  API Key Security:
  - OAuth 2.0 authentication with JWT tokens (expiry: 1 hour)
  - API key rotation every 90 days (automated reminders)
  - Separate keys for test vs production environments
  - Key scoping: Restrict permissions per key (read-only, write, admin)
  - Anomaly detection: Alert on API usage from new IPs or unusual patterns
  - Automatic key revocation after 5 failed authentication attempts
  - GitHub secret scanning to detect leaked keys
  - Cost: $2,000/month for security monitoring tools
  
  Input Validation and Sanitization:
  - Parameterized queries (no string concatenation in SQL)
  - Input validation on all API parameters using JSON schema
  - WAF (Web Application Firewall) blocking common injection patterns
  - Regular security code reviews and SAST scanning
  - Quarterly penetration testing by external security firm
  - Cost: $30,000/year for pen testing
  
  TLS Encryption:
  - Enforce TLS 1.3 for all API connections
  - Certificate pinning available for mobile SDKs
  - HSTS (HTTP Strict Transport Security) header enabled
  - Disable TLS 1.0 and 1.1 (deprecated due to vulnerabilities)
  - Perfect Forward Secrecy (PFS) enabled
  - A+ rating on SSL Labs test
  
  Account Security:
  - Two-factor authentication (2FA) required for production API access
  - TOTP or hardware keys (YubiKey) supported
  - Password requirements: 12+ chars, complexity rules, breach checking
  - Account lockout after 5 failed login attempts (15-minute lockout)
  - Session timeout: 30 minutes of inactivity
  - Login notification emails for new devices/locations
  
  Rate Limiting for Abuse Prevention:
  - Tiered rate limits: 100-10,000 requests per hour based on plan
  - Stricter limits on sensitive endpoints (POST /transactions: 50% of limit)
  - IP-based rate limiting: Max 1,000 req/hour per IP
  - CAPTCHA challenges after repeated failures
  - Automatic IP blocking for brute force attempts
  - Card testing detection: Block after 10 declined cards from same IP
  
  Secure Logging Practices:
  - PII scrubbing: Automatic redaction of email, phone, addresses in logs
  - Payment data: Never log card numbers, CVV, or full PANs
  - Audit logs: Separate system for compliance logging (immutable)
  - Log access: Restricted to security team and senior engineers only
  - Log retention: 13 months hot storage, 7 years cold storage
  - SIEM integration: Real-time security monitoring and alerting
  
  Role-Based Access Control (RBAC):
  - Principle of least privilege applied to all systems
  - Database access: Only 3 senior engineers have production read access
  - Production deployments: Require approval from 2 team leads
  - Customer data access: Logged and audited (alerts on unusual access)
  - Annual access reviews to remove unnecessary permissions
  - Offboarding automation: All access revoked within 1 hour
  
  Vendor Risk Management:
  - Annual security assessments of all vendors
  - SOC 2 Type II certification required for critical vendors
  - Data processing agreements (DPAs) with all vendors
  - Minimal data sharing: Only necessary PII shared with vendors
  - Regular vendor security questionnaires
  - Incident notification: Vendors must report breaches within 24 hours
  
  Security Audits:
  - Annual PCI-DSS Level 1 compliance audit (required)
  - Quarterly internal security assessments
  - Monthly automated vulnerability scanning
  - Bug bounty program: $100-$10,000 per finding
  - Security training: Quarterly training for all engineers
  - Incident response drills: Simulated breaches quarterly
  - Cost: $150,000/year for security program

dataRisks: >
  Payment Data Breach:
  - Risk: Unauthorized access to tokenized payment data or encryption keys
  - Impact: Exposure of customer payment information, massive regulatory fines
  - Potential damage: $5M+ in fines, lawsuits, reputation damage
  - Affected records: 500,000+ stored payment methods
  - Regulatory: PCI-DSS non-compliance, GDPR violations
  
  Transaction Data Corruption:
  - Risk: Software bug or hardware failure corrupting transaction records
  - Impact: Financial discrepancies, incorrect settlements, audit failures
  - Business impact: $100K+ in incorrect settlements, merchant disputes
  - Affected systems: Primary database, settlement processing
  
  Unauthorized Access to Customer Records:
  - Risk: Insider threat or compromised credentials accessing PII
  - Impact: Privacy violations, identity theft, regulatory fines
  - GDPR exposure: €20M or 4% of annual revenue
  - Records at risk: 500,000 customer profiles with PII
  
  Data Loss During Migration:
  - Risk: Data corruption or loss during database upgrade or migration
  - Impact: Permanent loss of transaction history, customer data
  - Business impact: Inability to reconcile past transactions
  - Recovery time: Could take days to restore from backups
  
  Compliance Violations (GDPR, PCI-DSS):
  - Risk: Failure to meet data protection requirements
  - Impact: Fines, loss of payment processing ability, lawsuits
  - PCI-DSS: Loss of ability to process card payments
  - GDPR: Up to €20M fines for serious violations
  - Business continuity risk: Cannot operate without compliance
  
  Backup Corruption or Loss:
  - Risk: Backups corrupted or incomplete, cannot restore in disaster
  - Impact: Data loss, extended downtime, business continuity failure
  - RPO at risk: Could lose up to 24 hours of data
  - RTO at risk: Recovery could take days instead of hours
  
  Accidental Data Deletion:
  - Risk: Human error deleting production data
  - Impact: Loss of critical customer or transaction data
  - Common scenario: Misconfigured script, wrong database connection
  - Blast radius: Could affect thousands of records

mitigateDataRisks: >
  Encryption and Tokenization:
  - All PII encrypted at rest using AES-256-GCM
  - Card numbers tokenized immediately upon receipt (never stored)
  - Separate token vault with isolated database
  - Field-level encryption for sensitive fields (email, SSN, bank accounts)
  - Encryption keys rotated every 90 days
  - Key management: AWS KMS with hardware security modules (HSM)
  - Cost: $5,000/month for HSM and key management
  
  Data Integrity Checks:
  - Transaction checksums validated on read/write
  - Daily integrity scans comparing checksums
  - Automated alerts on checksum mismatches
  - ACID compliance for all financial transactions
  - Database constraints: Foreign keys, check constraints, not null
  - Regular database consistency checks (DBCC commands)
  
  Access Control and Audit Logging:
  - Role-based access control (RBAC) for all data access
  - Database access limited to 3 senior engineers (read-only)
  - All customer data access logged with timestamp, user, purpose
  - Failed access attempts logged and monitored
  - Quarterly access reviews and permission audits
  - Privileged access management (PAM) for sensitive operations
  - Cost: $10,000/year for PAM tool licensing
  
  Backup Strategy (3-2-1 Rule):
  - 3 copies of data: Production + 2 backups
  - 2 different media: Database snapshots + file system backups
  - 1 offsite: Cross-region backups in separate AWS region
  - Automated daily backups at 2 AM EST
  - Transaction log backups every 5 minutes (for point-in-time recovery)
  - Backup retention: 30 days online, 7 years archived to Glacier
  - Monthly backup restoration tests to verify integrity
  - Cost: $8,000/month for backup storage and testing
  
  Data Retention and Deletion:
  - Active customer data retained indefinitely while account active
  - Transaction data: 7 years (regulatory requirement)
  - Customer right to deletion (GDPR): Data anonymized within 30 days
  - Deleted customer identifier: customer_id changed to 'DELETED_[hash]'
  - Payment methods: Deleted 1 year after last use (unless customer requests sooner)
  - Backup data: Also subject to deletion requests (compliance requirement)
  
  PCI-DSS Compliance:
  - Annual Level 1 PCI-DSS audit by Qualified Security Assessor (QSA)
  - Quarterly network vulnerability scans
  - Card data never stored (tokenization via Stripe)
  - Cardholder data environment (CDE) segregated from other systems
  - Regular security training for all employees
  - Documented policies and procedures reviewed annually
  - Cost: $100,000/year for PCI-DSS compliance program
  
  GDPR Compliance:
  - Data processing agreements with all vendors
  - Privacy policy updated and consent obtained
  - Data portability: Customers can export all data as JSON/CSV
  - Right to be forgotten: 30-day deletion process
  - Data breach notification: 72-hour reporting to authorities
  - Privacy by design: Minimal data collection principles
  - DPO (Data Protection Officer) appointed
  - Cost: $50,000/year for GDPR compliance program
  
  Change Management and Safeguards:
  - All production changes require peer review
  - Database migrations tested in staging environment first
  - Automated database migration rollback capability
  - Production access logged and monitored
  - Read-only access by default (write requires explicit approval)
  - Dangerous operations (DELETE, DROP) require two-person approval
  - Soft deletes by default (data marked deleted, not physically removed)
  - 30-day retention of soft-deleted data before permanent deletion
  
  Disaster Recovery Plan:
  - Documented DR procedures tested quarterly
  - RPO (Recovery Point Objective): 5 minutes
  - RTO (Recovery Time Objective): 15 minutes
  - Automated failover to secondary region
  - DR scenarios tested: Database corruption, region failure, ransomware
  - Incident response team trained and on-call 24/7
  - Insurance: Cyber liability insurance ($2M coverage)
  - Cost: $20,000/year for cyber insurance
